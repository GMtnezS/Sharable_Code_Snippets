<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Linky - Mobile Prototype</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            overflow-x: hidden;
        }

        .container {
            max-width: 100vw;
            min-height: 100vh;
            position: relative;
        }

        /* Import Screen */
        .import-screen {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
            text-align: center;
            animation: fadeIn 0.8s ease-out;
        }

        .import-screen.hidden {
            display: none;
        }

        .logo {
            font-size: 3rem;
            font-weight: bold;
            color: white;
            margin-bottom: 1rem;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .tagline {
            font-size: 1.1rem;
            color: rgba(255,255,255,0.9);
            margin-bottom: 2rem;
            line-height: 1.4;
        }

        .upload-area {
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: 40px 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
            border: 2px dashed #667eea;
            transition: all 0.3s ease;
            cursor: pointer;
            width: 100%;
            max-width: 350px;
        }

        .upload-area:hover {
            transform: translateY(-5px);
            box-shadow: 0 25px 50px rgba(0,0,0,0.15);
        }

        .upload-icon {
            font-size: 4rem;
            color: #667eea;
            margin-bottom: 1rem;
        }

        .upload-text {
            font-size: 1.2rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 0.5rem;
        }

        .upload-subtext {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 1.5rem;
        }

        .supported-formats {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-bottom: 1.5rem;
        }

        .format-tag {
            background: #f0f0f0;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.8rem;
            color: #555;
        }

        .privacy-note {
            font-size: 0.8rem;
            color: #777;
            max-width: 280px;
            line-height: 1.3;
        }

        /* Loading Screen */
        .loading-screen {
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
            text-align: center;
        }

        .loading-screen.active {
            display: flex;
        }

        .spinner {
            width: 60px;
            height: 60px;
            border: 4px solid rgba(255,255,255,0.3);
            border-top: 4px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 2rem;
        }

        .progress-text {
            color: white;
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .progress-subtext {
            color: rgba(255,255,255,0.8);
            font-size: 0.9rem;
        }

        /* Main App */
        .main-app {
            display: none;
            background: #f8f9fa;
            min-height: 100vh;
        }

        .main-app.active {
            display: block;
        }

        .header {
            background: white;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-title {
            font-size: 1.5rem;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }

        .search-bar {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e9ecef;
            border-radius: 25px;
            font-size: 1rem;
            outline: none;
            transition: border-color 0.3s ease;
        }

        .search-bar:focus {
            border-color: #667eea;
        }

        .posts-grid {
            padding: 20px;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
            gap: 15px;
        }

        .post-card {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            user-select: none;
        }

        .post-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .post-card.stacked {
            position: relative;
        }

        .post-card.stacked::before {
            content: '';
            position: absolute;
            top: -3px;
            left: 3px;
            right: -3px;
            height: 100%;
            background: rgba(255,255,255,0.8);
            border-radius: 15px;
            z-index: -1;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .post-card.stacked::after {
            content: '';
            position: absolute;
            top: -6px;
            left: 6px;
            right: -6px;
            height: 100%;
            background: rgba(255,255,255,0.6);
            border-radius: 15px;
            z-index: -2;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .card-image {
            width: 100%;
            height: 120px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 2rem;
        }

        .card-content {
            padding: 12px;
        }

        .card-title {
            font-size: 0.9rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 6px;
            line-height: 1.3;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .card-date {
            font-size: 0.8rem;
            color: #666;
        }

        /* Drag and Drop Styles */
        .post-card.dragging {
            opacity: 0.8;
            transform: scale(1.1) rotate(5deg);
            box-shadow: 0 15px 30px rgba(0,0,0,0.3);
            z-index: 1000;
            pointer-events: none;
            position: fixed;
            transition: none;
        }

        .post-card.drop-target {
            border: 2px dashed #667eea;
            opacity: 0.7;
        }

        .post-card.drop-hover {
            transform: scale(1.05);
            border-color: #28a745;
            background: #f8fff8;
        }

        .cluster-count {
            position: absolute;
            top: -8px;
            right: -8px;
            background: #667eea;
            color: white;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: bold;
            border: 2px solid white;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            z-index: 10;
        }

        /* Post Detail Modal */
        .post-detail {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: white;
            z-index: 1000;
            overflow-y: auto;
        }

        .post-detail.active {
            display: block;
            animation: slideUp 0.3s ease-out;
        }

        .detail-header {
            background: white;
            padding: 20px;
            border-bottom: 1px solid #e9ecef;
            position: sticky;
            top: 0;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .back-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: #667eea;
            cursor: pointer;
        }

        .detail-content {
            padding: 20px;
        }

        .detail-image {
            width: 100%;
            height: 250px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            border-radius: 15px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 3rem;
        }

        .detail-title {
            font-size: 1.3rem;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
            line-height: 1.4;
        }

        .detail-text {
            font-size: 1rem;
            color: #555;
            line-height: 1.6;
            margin-bottom: 20px;
        }

        .detail-meta {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .detail-date {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 5px;
        }

        .notes-section {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #e9ecef;
        }

        .notes-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 15px;
        }

        .notes-input {
            width: 100%;
            min-height: 100px;
            padding: 15px;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            font-size: 1rem;
            resize: vertical;
            outline: none;
            transition: border-color 0.3s ease;
        }

        .notes-input:focus {
            border-color: #667eea;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes slideUp {
            from { transform: translateY(100%); }
            to { transform: translateY(0); }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .file-input {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Import Screen -->
        <div class="import-screen" id="importScreen">
            <div class="logo">Linky</div>
            <div class="tagline">Your LinkedIn posts, organized and offline<br>Privacy-first. Your data stays on your device.</div>
            
            <div class="upload-area" onclick="document.getElementById('fileInput').click()">
                <div class="upload-icon">üìÅ</div>
                <div class="upload-text">Import Your Posts</div>
                <div class="upload-subtext">Select your LinkedIn export file</div>
                
                <div class="supported-formats">
                    <span class="format-tag">CSV</span>
                    <span class="format-tag">JSON</span>
                </div>
                
                <div class="privacy-note">
                    Your data is processed locally and never leaves your device. We don't store or access your personal information.
                </div>
            </div>
            
            <input type="file" id="fileInput" class="file-input" accept=".csv,.json" />
        </div>

        <!-- Loading Screen -->
        <div class="loading-screen" id="loadingScreen">
            <div class="spinner"></div>
            <div class="progress-text" id="progressText">Processing posts...</div>
            <div class="progress-subtext">Processing post 47 of 203</div>
            <div class="progress-subtext" style="margin-top: 20px; max-width: 280px;">
                You can close the app - we'll notify you when import is complete.
            </div>
        </div>

        <!-- Main App -->
        <div class="main-app" id="mainApp">
            <div class="header">
                <div class="header-title">Your Posts</div>
                <input type="text" class="search-bar" placeholder="Search posts, tags, or dates...">
            </div>

            <div class="posts-grid" id="postsGrid">
                <!-- Sample posts -->
                <div class="post-card" data-post="1">
                    <div class="card-image">üöÄ</div>
                    <div class="card-content">
                        <div class="card-title">Excited to share our latest product launch...</div>
                        <div class="card-date">Mar 15, 2024</div>
                    </div>
                </div>

                <div class="post-card stacked" data-post="2">
                    <div class="card-image">üí°</div>
                    <div class="card-content">
                        <div class="card-title">5 lessons learned from building a startup...</div>
                        <div class="card-date">Mar 12, 2024</div>
                    </div>
                    <div class="cluster-count">3</div>
                </div>

                <div class="post-card" data-post="3">
                    <div class="card-image">üéØ</div>
                    <div class="card-content">
                        <div class="card-title">Setting goals that actually matter in 2024...</div>
                        <div class="card-date">Mar 10, 2024</div>
                    </div>
                </div>

                <div class="post-card" data-post="4">
                    <div class="card-image">üåü</div>
                    <div class="card-content">
                        <div class="card-title">Reflecting on an amazing year of growth...</div>
                        <div class="card-date">Mar 8, 2024</div>
                    </div>
                </div>

                <div class="post-card" data-post="5">
                    <div class="card-image">üìà</div>
                    <div class="card-content">
                        <div class="card-title">Data visualization tips that changed how I...</div>
                        <div class="card-date">Mar 5, 2024</div>
                    </div>
                </div>

                <div class="post-card stacked" data-post="6">
                    <div class="card-image">ü§ù</div>
                    <div class="card-content">
                        <div class="card-title">Building meaningful professional relationships...</div>
                        <div class="card-date">Mar 3, 2024</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Post Detail Modal -->
        <div class="post-detail" id="postDetail">
            <div class="detail-header">
                <button class="back-btn" id="backBtn">‚Üê</button>
                <div class="header-title">Post Details</div>
            </div>
            
            <div class="detail-content">
                <div class="detail-image" id="detailImage">üöÄ</div>
                <div class="detail-title" id="detailTitle">Excited to share our latest product launch and the incredible journey we've been on!</div>
                
                <div class="detail-meta">
                    <div class="detail-date">Published: March 15, 2024</div>
                </div>
                
                <div class="detail-text" id="detailText">
                    After months of hard work, late nights, and countless iterations, we're finally ready to show the world what we've been building. This product represents not just our technical capabilities, but our commitment to solving real problems for real people.
                    <br><br>
                    The response from our beta users has been incredible, and we can't wait to see how this impacts the industry. Special thanks to our amazing team who made this possible!
                </div>

                <div class="notes-section">
                    <div class="notes-title">Personal Notes</div>
                    <textarea class="notes-input" placeholder="Add your thoughts, reactions, or reminders about this post..."></textarea>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentView = 'import';
        
        // File input handler
        document.getElementById('fileInput').addEventListener('change', function(e) {
            if (e.target.files.length > 0) {
                showLoading();
                // Simulate processing
                setTimeout(showMainApp, 3000);
            }
        });

        function showLoading() {
            document.getElementById('importScreen').classList.add('hidden');
            document.getElementById('loadingScreen').classList.add('active');
            currentView = 'loading';
        }

        function showMainApp() {
            document.getElementById('loadingScreen').classList.remove('active');
            document.getElementById('mainApp').classList.add('active');
            currentView = 'main';
        }

        // Drag and Drop for Clustering/Grouping (Touch + Mouse Support)
        let draggedCard = null;
        let isDragging = false;
        let dragStartTime = 0;
        let dragTimeout = null;
        let startPos = { x: 0, y: 0 };
        let tapTimer = null;

        // Global mouse move and mouse up for proper drag handling
        document.addEventListener('mousemove', function(e) {
            if (isDragging && draggedCard) {
                handleDragMove(draggedCard, e.clientX, e.clientY, e);
            }
        });

        document.addEventListener('mouseup', function(e) {
            if (isDragging && draggedCard) {
                completeDrag(draggedCard, e.clientX, e.clientY);
            }
        });

        document.querySelectorAll('.post-card').forEach(card => {
            // =============
            // TOUCH EVENTS
            // =============
            card.addEventListener('touchstart', function(e) {
                initiateDrag(this, e.touches[0].clientX, e.touches[0].clientY, e);
            }, { passive: false });

            card.addEventListener('touchmove', function(e) {
                handleDragMove(this, e.touches[0].clientX, e.touches[0].clientY, e);
            }, { passive: false });

            card.addEventListener('touchend', function(e) {
                completeDrag(this, e.changedTouches[0].clientX, e.changedTouches[0].clientY);
            });

            // =============
            // MOUSE EVENTS
            // =============
            card.addEventListener('mousedown', function(e) {
                e.preventDefault(); // Prevent text selection
                initiateDrag(this, e.clientX, e.clientY, e);
            });

            // Prevent context menu on long press
            card.addEventListener('contextmenu', function(e) {
                if (isDragging) {
                    e.preventDefault();
                }
            });
        });

        function initiateDrag(card, x, y, e) {
            dragStartTime = Date.now();
            startPos = { x: x, y: y };
            
            // Long press detection for drag mode
            dragTimeout = setTimeout(() => {
                if (!isDragging) {
                    startDrag(card, e);
                }
            }, 500);
        }

        function handleDragMove(card, x, y, e) {
            const currentPos = { x: x, y: y };
            
            const distance = Math.sqrt(
                Math.pow(currentPos.x - startPos.x, 2) + 
                Math.pow(currentPos.y - startPos.y, 2)
            );

            // If moved too much, cancel long press
            if (distance > 10 && dragTimeout) {
                clearTimeout(dragTimeout);
                dragTimeout = null;
            }

            // If actively dragging
            if (isDragging && draggedCard === card) {
                if (e) e.preventDefault();
                
                // Update dragged card position
                card.style.position = 'fixed';
                card.style.left = (currentPos.x - 80) + 'px';
                card.style.top = (currentPos.y - 80) + 'px';
                card.style.zIndex = '1000';
                card.style.pointerEvents = 'none';

                // Check for drop targets
                const dropTarget = findDropTarget(currentPos.x, currentPos.y);
                highlightDropTarget(dropTarget);
            }
        }

        function completeDrag(card, x, y) {
            if (dragTimeout) {
                clearTimeout(dragTimeout);
                dragTimeout = null;
            }

            if (isDragging && draggedCard === card) {
                const dropTarget = findDropTarget(x, y);
                
                if (dropTarget && dropTarget !== card) {
                    // Create cluster/group
                    createCluster(card, dropTarget);
                }
                
                endDrag(card);
            } else {
                // Handle normal click/tap behavior
                const tapDuration = Date.now() - dragStartTime;
                if (tapDuration < 500) {
                    handleTap(card);
                }
            }
        }

        function startDrag(card, e) {
            draggedCard = card;
            isDragging = true;
            
            // Visual feedback for drag start
            card.classList.add('dragging');
            
            // Add drop target indicators to all other cards
            document.querySelectorAll('.post-card').forEach(otherCard => {
                if (otherCard !== card) {
                    otherCard.classList.add('drop-target');
                }
            });
            
            // Haptic feedback (if supported)
            if (navigator.vibrate) {
                navigator.vibrate(50);
            }
            
            e.preventDefault();
        }

        function findDropTarget(x, y) {
            // Temporarily hide dragged card to check what's underneath
            if (draggedCard) {
                const originalPointerEvents = draggedCard.style.pointerEvents;
                draggedCard.style.pointerEvents = 'none';
                
                const elementBelow = document.elementFromPoint(x, y);
                const dropTarget = elementBelow ? elementBelow.closest('.post-card') : null;
                
                draggedCard.style.pointerEvents = originalPointerEvents;
                
                return dropTarget && dropTarget !== draggedCard ? dropTarget : null;
            }
            return null;
        }

        function highlightDropTarget(target) {
            // Remove previous highlights
            document.querySelectorAll('.post-card.drop-hover').forEach(card => {
                card.classList.remove('drop-hover');
            });
            
            // Add highlight to current target
            if (target) {
                target.classList.add('drop-hover');
            }
        }

        function createCluster(draggedCard, targetCard) {
            // Visual feedback for successful cluster
            if (navigator.vibrate) {
                navigator.vibrate([50, 50, 50]);
            }
            
            // Make target card stacked
            targetCard.classList.add('stacked');
            
            // Add or update cluster count
            let clusterCount = targetCard.querySelector('.cluster-count');
            if (!clusterCount) {
                clusterCount = document.createElement('div');
                clusterCount.className = 'cluster-count';
                clusterCount.textContent = '2';
                targetCard.appendChild(clusterCount);
            } else {
                const currentCount = parseInt(clusterCount.textContent) || 1;
                clusterCount.textContent = currentCount + 1;
            }
            
            // Hide the dragged card (simulate adding to cluster)
            draggedCard.style.display = 'none';
            
            // Visual success animation
            targetCard.style.animation = 'pulse 0.6s ease';
            setTimeout(() => {
                targetCard.style.animation = '';
            }, 600);
        }

        function endDrag(card) {
            isDragging = false;
            draggedCard = null;
            
            // Reset dragged card styles
            card.classList.remove('dragging');
            card.style.position = '';
            card.style.left = '';
            card.style.top = '';
            card.style.zIndex = '';
            card.style.pointerEvents = '';
            
            // Remove drop target indicators
            document.querySelectorAll('.post-card').forEach(otherCard => {
                otherCard.classList.remove('drop-target', 'drop-hover');
            });
        }

        function handleTap(card) {
            if (tapTimer) {
                clearTimeout(tapTimer);
                tapTimer = null;
                // Double tap - open detail
                openPostDetail(card.dataset.post);
            } else {
                // Single tap - show preview
                tapTimer = setTimeout(() => {
                    tapTimer = null;
                    // Single tap animation
                    card.style.transform = 'scale(0.95)';
                    setTimeout(() => {
                        card.style.transform = '';
                    }, 150);
                }, 200);
            }
        }

        function openPostDetail(postId) {
            document.getElementById('postDetail').classList.add('active');
        }

        document.getElementById('backBtn').addEventListener('click', function() {
            document.getElementById('postDetail').classList.remove('active');
        });
    </script>
</body>
</html>